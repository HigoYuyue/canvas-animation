### ç®€ä»‹
- H5æ–°æ ‡ç­¾
- çŸ©å½¢åŒºåŸŸç”»å¸ƒ
- ä½¿ç”¨ javascript ç”»å›¾
- å¯ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒ

### canvas ç»˜åˆ¶åŸºæœ¬è¯´æ˜
- åæ ‡ç³»ï¼Œå·¦ä¸Šè§’ 0ï¼Œ0ã€‚Xå‘å³å¢å¤§ï¼ŒYå‘ä¸‹å¢å¤§

- ç»˜å›¾å°±æ˜¯ä½¿ç”¨JSè°ƒç”¨Canvasçš„æ¥å£å®Œæˆçš„ï¼Œè€Œè¿™ä¸ªæ¥å£å°±æ˜¯Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰å¯¹è±¡
- ä½¿ç”¨[CanvasElement].getContext(â€˜2dâ€™)æ¥è·å–2Dç»˜å›¾ä¸Šä¸‹æ–‡ã€‚`æ­¥éª¤1`
- ç»˜åˆ¶èµ·ç‚¹ï¼šctx.moveTo(x, y); //x,y éƒ½æ˜¯ç›¸å¯¹äº canvasç›’å­çš„æœ€å·¦ä¸Šè§’ã€‚`æ­¥éª¤2`
- ç»˜åˆ¶ç»ˆç‚¹ï¼šctx.lineTo(x, y); //ä»x,yçš„ä½ç½®ç»˜åˆ¶ä¸€æ¡ç›´çº¿åˆ°èµ·ç‚¹æˆ–è€…ä¸Šä¸€ä¸ªçº¿å¤´ç‚¹ã€‚`æ­¥éª¤3`
- å¼€å§‹è·¯å¾„ï¼šctx.beginPath();ä½œç”¨ï¼šå°†å½“å‰è·¯å¾„å’Œä¹‹å‰è·¯å¾„éš”ç¦»,æ–¹ä¾¿ä½ å¯¹å½“å‰è·¯å¾„è¿›è¡Œè®¾ç½®æ ·å¼,çº¿å®½.`æ­¥éª¤2(1)`
- é—­åˆè·¯å¾„ï¼šctx.closePath();ä½œç”¨ï¼šé—­åˆè·¯å¾„ä¼šè‡ªåŠ¨æŠŠæœ€åçš„çº¿å¤´å’Œå¼€å§‹çš„çº¿å¤´è¿åœ¨ä¸€èµ·ã€‚`æ­¥éª¤4`
- æè¾¹ï¼šctx.stroke();`æ­¥éª¤5`
- å¡«å……ï¼šctx.fill();`æ­¥éª¤5(1)`

### ç”»å›¾
#### çº¿
```js
context.beginPath();//å¼€å§‹æ–°çš„ç»˜åˆ¶è·¯å¾„
context.moveTo(0,500);//è®¾ç½®å¼€å§‹ç‚¹
context.lineTo(500,0);//è®¾ç½®ç»“æŸç‚¹å¹¶è¿æ¥å¼€å§‹ç‚¹å’Œç»“æŸç‚¹
context.stroke();//å°†å›¾åƒç»˜åˆ¶å‡ºæ¥
```
##### åŸºæœ¬å±æ€§
lineWidth
fillStyle = color //colorå¯ä»¥æ˜¯é¢œè‰²å€¼ã€æ¸å˜å¯¹è±¡ã€å›¾æ¡ˆå¯¹è±¡
strokeStyle
##### è™šçº¿
ctx.setLineDash([4,2])
ctx.lineDashOffset = 5

#### è¡¨æ ¼
ğŸŒ°æ£‹ç›˜æ ¼

#### åœ†/çŸ©å½¢/å¼§çº¿
```js
ctx.arc(x,y,r,sAngle,eAngle,counterclockwise);// counterclockwise trueé€†æ—¶é’ˆ falseï¼šé¡ºæ—¶é’ˆ(é»˜è®¤) å¼§åº¦å’Œè§’åº¦çš„è½¬æ¢å…¬å¼ï¼š rad = deg*Math.PI/180; 
ctx.rect(x,y,width,height) //çŸ©å½¢
ctx.strokeRect(x, y, width, height);//ç«‹å³strokeç»˜åˆ¶å³æè¾¹
ctx.fillRect(x, y, width, height);//ç«‹å³å¡«å……
ctx.clearRect(x, y, width, hegiht);//æ¸…ç©ºrect
//ç”»åœ†å¼§
ctx.moveTo(x0,y0);
ctx.arcTo(x1,y1,x2,y2,radius);//x0ã€y0æŒ‡çš„æ˜¯åœ†å¼§çš„èµ·å§‹ç‚¹ï¼›x1ã€y1ï¼Œx2ã€y2æŒ‡çš„åˆ‡çº¿çš„ä¸¤ä¸ªç‚¹
```
åœ†å½¢ä¸Šé¢çš„ç‚¹çš„åæ ‡çš„è®¡ç®—å…¬å¼:

x =x0 + Math.cos(rad) * R;//x0å’Œy0æ˜¯åœ†å¿ƒç‚¹åæ ‡
y =y0 + Math.sin(rad) * R;//æ³¨æ„éƒ½æ˜¯å¼§åº¦
#### æ–‡å­—
```
ctx.font='30px Arial';
ctx.fillText('text',x,y);//å®å¿ƒæ–‡æœ¬
ctx.strokeText('text',x,y);//ç©ºå¿ƒæ–‡æœ¬
```
#### å›¾ç‰‡
```js
ctx.drawImage(image,x,y);//x,yå·¦ä¸Šè§’åæ ‡
```
#### ç”»æ¿
```js
//1.è·å–canvaså’Œä¸Šä¸‹æ–‡
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
    //2.ç›‘å¬é¼ æ ‡çš„ç§»åŠ¨
canvas.onmousedown = function (event){
        //æ¸…å±æ“ä½œ
        ctx.clearRect(0,0,canvas.width,canvas.height);
        //å¼€å¯è·¯å¾„
        ctx.beginPath();
        //èµ·ç‚¹
        ctx.moveTo(event.offsetX, event.offsetY);
        canvas.onmousemove = function (event){
            //ç»ˆç‚¹
            ctx.lineTo(event.offsetX, event.offsetY);

            //è®¾ç½®é¢œè‰²å’Œçº¿å®½
            ctx.strokeStyle = 'red';
            ctx.lineWidth = 5;
            //ç»˜åˆ¶ æè¾¹
            ctx.stroke();
        };
        canvas.onmouseup = function (){
            canvas.onmousemove = null;
            canvas.onmouseup = null;
        };

    };
```
#### åœ†ç¯
ğŸŒ°è§éé›¶æ­£äº¤åŸåˆ™ç¤ºä¾‹
#### é¥¼çŠ¶å›¾
#### å¸§åŠ¨ç”»
##### requestAnimationFrame
å®šä¹‰ï¼šæµè§ˆå™¨ç”¨äºå®šæ—¶å¾ªç¯æ“ä½œçš„ä¸€ä¸ªæ¥å£ï¼Œç±»ä¼¼äºsetTimeoutï¼Œä¸»è¦ç”¨é€”æ˜¯æŒ‰å¸§å¯¹ç½‘é¡µè¿›è¡Œé‡ç»˜ã€‚
ç›®çš„ï¼š
ä¸ºäº†è®©å„ç§ç½‘é¡µåŠ¨ç”»æ•ˆæœï¼ˆDOMåŠ¨ç”»ã€CanvasåŠ¨ç”»ã€SVGåŠ¨ç”»ã€WebGLåŠ¨ç”»ï¼‰èƒ½å¤Ÿæœ‰ä¸€ä¸ªç»Ÿä¸€çš„åˆ·æ–°æœºåˆ¶ï¼Œä»è€ŒèŠ‚çœç³»ç»Ÿèµ„æºï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ï¼Œæ”¹å–„è§†è§‰æ•ˆæœ
ä½¿ç”¨ï¼š
```js
function callback() {
  // Do whatever
  requestID=window.requestAnimationFrame(callback);//requestID ä»£è¡¨ä»»åŠ¡IDçš„æ•´æ•°å€¼
}// éœ€è¦å¾ªç¯è°ƒç”¨
requestID=window.requestAnimationFrame(callback);
```
å–æ¶ˆé‡ç»˜ï¼š
window.cancelAnimationFrame(requestID);
[äº†è§£æ›´å¤š](http://javascript.ruanyifeng.com/htmlapi/requestanimationframe.html)
#### å˜å½¢
##### å‰æ
ctx.save()
ctx.restore()
Canvas çš„çŠ¶æ€å°±æ˜¯å½“å‰ç”»é¢åº”ç”¨çš„æ‰€æœ‰æ ·å¼å’Œå˜å½¢çš„ä¸€ä¸ªå¿«ç…§ã€‚
CanvasçŠ¶æ€å­˜å‚¨åœ¨æ ˆä¸­ï¼Œæ¯å½“save()æ–¹æ³•è¢«è°ƒç”¨åï¼Œå½“å‰çš„çŠ¶æ€å°±è¢«æ¨é€åˆ°æ ˆä¸­ä¿å­˜ã€‚
å¯ä»¥è°ƒç”¨ä»»æ„å¤šæ¬¡ save æ–¹æ³•ã€‚æ¯ä¸€æ¬¡è°ƒç”¨ restore æ–¹æ³•ï¼Œä¸Šä¸€ä¸ªä¿å­˜çš„çŠ¶æ€å°±ä»æ ˆä¸­å¼¹å‡ºï¼Œæ‰€æœ‰è®¾å®šéƒ½æ¢å¤ã€‚
##### æ–¹æ³•
- translate(x, y) ç§»åŠ¨ canvas å’Œå®ƒçš„åŸç‚¹åˆ°ä¸€ä¸ªä¸åŒçš„ä½ç½®ã€‚
- rotate(angle) ä»¥åŸç‚¹ä¸ºä¸­å¿ƒæ—‹è½¬ é¡ºæ—¶é’ˆæ–¹å‘ ä»¥å¼§åº¦ä¸ºå•ä½
- scale(x, y) x,y åˆ†åˆ«æ˜¯æ¨ªè½´å’Œçºµè½´çš„ç¼©æ”¾å› å­
- context.transform(a,b,c,d,e,f)
   
```
|a,c,e|
|b,d,f|
|0,0,1|
a,dä»£è¡¨æ°´å¹³ã€å‚ç›´ç¼©æ”¾;b,cä»£è¡¨æ°´å¹³ã€å‚ç›´å€¾æ–œ;e,fä»£è¡¨æ°´å¹³ã€å‚ç›´ä½ç§»
transform() æ–¹æ³•çš„è¡Œä¸ºç›¸å¯¹äºç”± rotate(), scale(), translate(), or transform() å®Œæˆçš„å…¶ä»–å˜æ¢
ctx.setTransform(a,b,c,d,e,f) æ–¹æ³•ï¼Œå®ƒä¸ä¼šç›¸å¯¹äºå…¶ä»–å˜æ¢æ¥å‘ç”Ÿè¡Œä¸ºã€‚
```
#### é‡å¤å…ƒç´ 
è¢«é‡å¤çš„å…ƒç´ å¯ç”¨äºç»˜åˆ¶/å¡«å……çŸ©å½¢ã€åœ†å½¢æˆ–çº¿æ¡ç­‰ç­‰ã€‚
```js
context.createPattern(image/canvas,'repeat|repeat-x|repeat-y|no-repeat');// image è§„å®šè¦ä½¿ç”¨çš„æ¨¡å¼çš„å›¾ç‰‡ã€ç”»å¸ƒæˆ–è§†é¢‘å…ƒç´ 
```
æ•ˆæœå¦‚ä¸‹ï¼š
![27ea503b9fec4faa1b8a9c5fdd3038e6.png](evernotecid://32144DFA-56BA-424B-92B4-A6CC4E8E60A9/appyinxiangcom/24664158/ENResource/p55)


#### æ ·å¼ç›¸å…³
```js
context.fillStyle="red";// å¡«å……è‰²
context.strokeStyle = 'red';// æè¾¹è‰²
context.lineWidth = 0.5;// è®¾ç½®çº¿å®½
context.shadowBlur=20 //é˜´å½±å®½åº¦
context.shadowColor = 'pink'//é˜´å½±é¢œè‰²
context.shadowOffsetX //è®¾ç½®æˆ–è¿”å›é˜´å½±ä¸å½¢çŠ¶çš„æ°´å¹³åç§»è·ç¦»
context.shadowOffsetY //è®¾ç½®æˆ–è¿”å›é˜´å½±ä¸å½¢çŠ¶çš„å‚ç›´åç§»è·ç¦»
```
#### æ¸å˜
| çº¿æ€§æ¸å˜ | å¾„å‘/åœ†æ¸å˜ | ä¸Šè‰² |
|---|---|---|
| createLinearGradient(x1, y1, x2, y2) |createRadialGradient(x1, y1, r1, x2, y2, r2) |gradient.addColorStop(position, color)|
|èµ·ç‚¹ (x1,y1) ä¸ç»ˆç‚¹ (x2,y2)|ä»¥ (x1,y1) ä¸ºåŸç‚¹ï¼ŒåŠå¾„ä¸º r1 çš„åœ†ï¼Œåä¸‰ä¸ªå‚æ•°åˆ™å®šä¹‰å¦ä¸€ä¸ªä»¥ (x2,y2) ä¸ºåŸç‚¹ï¼ŒåŠå¾„ä¸º r2 çš„åœ†ã€‚|position å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ª 0.0 ä¸ 1.0 ä¹‹é—´çš„æ•°å€¼ï¼Œè¡¨ç¤ºæ¸å˜ä¸­é¢œè‰²æ‰€åœ¨çš„ç›¸å¯¹ä½ç½®|
ğŸŒ°
```js
//å¾„å‘æ¸å˜
var lg=context.createRadialGradient(50,450,0,80,500,100);
lg.addColorStop(0,"#ff0000");
lg.addColorStop(0.5,"#00ff00");
//ä½¿ç”¨è“è‰²å¡«å……
lg.addColorStop(1,"#0000ff");
context.fillStyle=lg;
context.fillRect(0,400,200,200);
```
#### å¡«å……â€”â€”éé›¶æ­£äº¤åŸåˆ™
äº¤å‰è·¯å¾„çš„å¡«å……é—®é¢˜ï¼Œâ€œéé›¶ç¯ç»•åŸåˆ™â€ï¼Œé¡ºé€†æ—¶é’ˆç©¿æ’æ¬¡æ•°å†³å®šæ˜¯å¦å¡«å……ã€‚
ä½¿ç”¨ä¸€ä¸ªåˆå§‹å€¼ä¸º0 çš„è®¡æ•°å™¨åˆ¤æ–­è¯¥åŒºåŸŸæ˜¯å¦å¡«å……?

1. å¯¹äºè·¯å¾„ä¸­ä»»æ„ç»™å®šçš„åŒºåŸŸ,ä»è¯¥åŒºåŸŸå†…éƒ¨ç”»ä¸€æ¡è¶³å¤Ÿé•¿çš„çº¿æ®µ,ä½¿æ­¤çº¿æ®µçš„ç»ˆç‚¹å®Œå…¨è½åœ¨è·¯å¾„èŒƒå›´å¤–éƒ¨.
2. å¦‚æœçº¿æ®µæ˜¯ä¸è·¯å¾„çš„é¡ºæ—¶é’ˆéƒ¨åˆ†ç›¸äº¤ï¼Œåˆ™è®¡æ•°å™¨åŠ 1ï¼Œ
3. å¦‚æœçº¿æ®µæ˜¯ä¸è·¯å¾„çš„é€†æ—¶é’ˆéƒ¨åˆ†ç›¸äº¤ï¼Œåˆ™è®¡æ•°å™¨å‡1
4. è‹¥è®¡æ•°å™¨çš„æœ€ç»ˆå€¼ä¸æ˜¯0ï¼Œé‚£ä¹ˆæ­¤åŒºåŸŸå°±åœ¨è·¯å¾„é‡Œé¢,åœ¨è°ƒç”¨fill()æ–¹æ³•æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šå¯¹å…¶è¿›è¡Œå¡«å……
5. å¦‚æœè®¡æ•°å™¨æœ€ç»ˆå€¼æ˜¯0ï¼Œé‚£ä¹ˆæ­¤åŒºåŸŸå°±ä¸åœ¨è·¯å¾„å†…éƒ¨ï¼Œæµè§ˆå™¨ä¹Ÿå°±ä¸ä¼šå¯¹å…¶è¿›è¡Œå¡«å……
ğŸŒ°åœ†ç¯
```js
//1.è·å–canvaså’Œä¸Šä¸‹æ–‡
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

//2.ç»˜åˆ¶åœ†ç¯
//å†…åœ†
ctx.arc(200,200,100,0,2 * Math.PI,false);
//å¤–åœ†
ctx.arc(200,200,200,0,2 * Math.PI,true);
//å¡«å……é¢œè‰²
ctx.fillStyle = 'pink';
ctx.fill();
```

### åº”ç”¨
- å¯è§†åŒ–æ•°æ®ï¼š å„ç±»ç»Ÿè®¡å›¾è¡¨ï¼Œæ¯”å¦‚:ç™¾åº¦çš„echart
- åœºæ™¯ç§€ï¼š ç”¨Canvaså®ç°åŠ¨æ€çš„å¹¿å‘Šæ•ˆæœèƒ½å¤Ÿéå¸¸èæ´½çš„è·¨å¹³å°è¿è¡Œ
- æ¸¸æˆï¼š canvasåœ¨åŸºäºWebçš„å›¾åƒæ˜¾ç¤ºæ–¹é¢æ¯”Flashæ›´åŠ ç«‹ä½“ã€æ›´åŠ ç²¾å·§ï¼Œcanvasæˆä¸ºHTML5å°æ¸¸æˆå¼€å‘é¦–é€‰
- å…¶ä»–å¯åµŒå…¥ç½‘ç«™çš„å†…å®¹ (å¤šç”¨äºæ´»åŠ¨é¡µé¢ã€ç‰¹æ•ˆ)ï¼šç±»ä¼¼å›¾è¡¨ã€éŸ³é¢‘ã€è§†é¢‘ï¼Œè¿˜æœ‰è®¸å¤šå…ƒç´ èƒ½å¤Ÿæ›´å¥½åœ°ä¸ Web èåˆï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•æ’ä»¶
### æ³¨æ„äº‹é¡¹
- åªæœ‰widthå’Œheightä¸¤ä¸ªå±æ€§ï¼Œé»˜è®¤300*150ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨csså®šä¹‰å¤§å°ï¼Œä½†ç»˜åˆ¶æ—¶å›¾åƒä¼šä¼¸ç¼©ä»¥é€‚åº”å®ƒçš„æ¡†æ¶å°ºå¯¸ï¼šå¦‚æœCSSçš„å°ºå¯¸ä¸åˆå§‹ç”»å¸ƒçš„æ¯”ä¾‹ä¸ä¸€è‡´ï¼Œå®ƒä¼šå‡ºç°æ‰­æ›²ã€‚
- åŒæ—¶å­˜åœ¨æè¾¹å’Œå¡«å……ï¼Œéœ€å…ˆå¡«å……åæè¾¹ï¼Œé¿å…è¦†ç›–
- canvas ä¸­å›¾å½¢å˜æ¢æ˜¯å åŠ çš„ã€‚æ‰€ä»¥ä»ç¬¬äºŒæ¬¡å˜æ¢ç›¸å¯¹çš„ä¸æ˜¯åˆå§‹çŠ¶æ€ã€‚å¯ä»¥ä½¿ç”¨ save å’Œ restore ä¿å­˜å˜æ¢çŠ¶æ€ï¼Œä½¿å…¶ä¸­ä¸€ä¸ªå˜æ¢ä¸å½±å“å…¶ä»–å˜æ¢ã€‚
- scale å˜æ¢ä¼šå½±å“èµ·å§‹ç‚¹åæ ‡ä»¥åŠè¾¹æ¡†çš„å®½åº¦
### å…¶ä»–
```js
// åº¦æ•°è½¬å¼§åº¦ d2a(90)
function d2a(n){
            return Math.PI*n/180;
        }
```
æ›´å¤šå¯æŸ¥çœ‹[canvas](https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Applying_styles_and_colors)
### è¸©å‘æŒ‡å—
[å‘](https://segmentfault.com/a/1190000012527772)

å¾…è°ƒç ”
canvas æ ·å¼ å®½é«˜

save restore
requestAnimationFrame

beginPath
